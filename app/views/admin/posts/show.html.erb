<div class="container">
  <div class="row">
    <div class="col-sm-12-col-md-4 col-lg-4">
      <div class="user_show border">
        <%= image_tag @post.user.get_user_image(100, 100) %>
        <span><%= @post.user.most_favorite %></span>
        <%= link_to user_path(@post.user.id) do %><%= @post.user.name %><% end %>
        <p><%= @post.user.introduction %></p>
        <ul>
          <li><%= link_to follow_user_path(@post.user.id), class:'btn btn-info' do %><%= @post.user.follow_user.count %>フォロー<% end %></li>
          <li><%= link_to followed_user_path(@post.user.id), class:'btn btn-info' do %><%= @post.user.followed_user.count %>フォロワー<% end %></li>
        </ul>
      </div>
    </div>
    <div class="col-sm-12 col-md-8 col-lg-8">
      <div class="post_header">
        <ul>
          <li><%= @post.shop_genre_i18n %></li>
          <li><%= @post.prefecture_i18n %></li>
          <li><i class="fa-regular fa-star"></i><%= @post.rate %></li>
        </ul>
          <%= link_to '制限する', restrict_viewing_admin_post_path(@post.id), method: :patch, data: { confirm: "よろしいですか？" }, class:'btn btn-danger' %>
      </div>
      <div class="post_main">
        <div class="post_main_header">
          <h3><%= @post.shop_name %></h3>
          <% @post.tags.each do |tag| %>
            <%= form_with url: search_tags_path do |g| %>
              <%= g.submit "#{tag.name}", class:'btn btn-info' %>
            <% end %>
          <% end %>
        </div>
        <div class="post_main_image_review">
          <div class="post_main_image">
            <% @post.post_images.each do |image| %>
              <%= image_tag image.variant(resize: "500x400") %>
            <% end %>
          </div>
          <div class="post_main_review">
            <%= @post.review %>
          </div>
        </div>
      </div>
      <div class="comment">
        <% @comments.each do |comment| %>
          <div class="comment_item">
            <%= link_to user_path(comment.user.id) do %>
              <%= image_tag comment.user.get_user_image(60, 60) %>
              <%= comment.user.name %>
            <% end %>
            <%= comment.text %>
            <% if current_user.id == comment.user.id %>
              <%= link_to '制限', admin_restrict_viewing_comment_path(@post.id, comment.id), method: :patch, class:'btn btn-danger' %>
            <% end %>
            <% comment.replies.each do |reply| %>
              <div class="reply_item">
                <%= link_to user_path(reply.user.id) do %>
                  <%= image_tag reply.user.get_user_image(50,50) %>
                  <%= reply.user.name %>
                <% end %>
                <%= reply.text %>
                <% if current_user.id == reply.user.id %>
                  <%= link_to '制限', admin_restrict_viewing_comment_path(@post.id, reply.id), method: :patch, class:'btn btn-danger' %>
                <% end %>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>